using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace AlgoTest.AOC2023;

class Galaxy
{
    public int Number { get; set; }
    public long Column { get; set; }
    public long Row { get; set; }
}

[TestClass]
public class Day11
{
    [TestMethod]
    public void Test()
    {
        // long expFactor =  2; // First Problem
        long expFactor =  1000000; // Second problem
        long answer = 0, answer2 = 0;
        
        var universe = new Dictionary<long, Dictionary<long, int>>();
        var galaxies = 0;

        long row = 0, expansion = 0;
        foreach (var line in data.Split('\n',StringSplitOptions.TrimEntries))
        {
            var empty = true;
            for (long column = 0; column < (long)line.Length; column++)
            {
                if (line[(int)column] == '#')
                {
                    empty = false;
                    galaxies++;
                    if (universe.ContainsKey(column))
                        universe[column][row + expansion] = galaxies;
                    else
                        universe.Add(column, new Dictionary<long, int> { { row + expansion, galaxies } });
                }
            }
            if (empty) expansion += expFactor - 1;
            row++;
        }

        var expUniverse = new List<Galaxy>();
        expansion = 0;
        for (long column = 0; column <= universe.Keys.Max(); column++)
            if (universe.ContainsKey(column))
            {
                foreach (KeyValuePair<long, int> loopRow in universe[column])
                    expUniverse.Add(new Galaxy { Number = loopRow.Value, Column = column + expansion, Row = loopRow.Key });
            }
            else
                expansion += expFactor - 1;
        

        for (var i = 0 ; i < expUniverse.Count - 1; i++)
        {
            for (var j = i + 1; j < expUniverse.Count; j++)
            {
                answer += (expUniverse[j].Column > expUniverse[i].Column ? expUniverse[j].Column - expUniverse[i].Column : expUniverse[i].Column - expUniverse[j].Column)
                    + (expUniverse[j].Row > expUniverse[i].Row ? expUniverse[j].Row - expUniverse[i].Row : expUniverse[i].Row - expUniverse[j].Row);
            }
        }
        Console.WriteLine(answer);
    }

    string data = """
                            ...........#..........#...........................#....................#......#........................................................#....
                            ...#........................#..............................#...................................................................#............
                            ......................................#...................................................................#...........#.....................
                            ...............................................#...............#.......................#....................................................
                            ..........................................#...........#.............................................#.......................................
                            ..........#.................................................................#................................#..............................
                            ................................#.................................................................................#......#..................
                            ..................................................................#.........................................................................
                            ............................................................#..................#.......................................................#....
                            ................................................#............................................#...............................#..............
                            .....#..............#..............................................................#................................#.......................
                            .........................................#...............................................#.................................................#
                            ..............................#................................#.......#....................................................................
                            ........................................................................................................................#...................
                            ...#......#.......#.................#...................#......................................#.......#.......#........................#...
                            ...........................................#...............................#....................................................#...........
                            ...................................................................................#........................................................
                            .............#............#........................................#.......................................#......#.........................
                            ................................#............................#...............................#..............................................
                            ........................................#.............#.........................#......#......................................#.............
                            ........................................................................................................#.....#.............................
                            ......#............#...............#..............#.........................................................................................
                            ...........#..................#............#.....................#..................................................#.......................
                            .......................................................................#..................#................#.......................#........
                            ..#...................................#.....................................#.....#..................#......................................
                            ............................................................................................................................................
                            ............................#........................#.........................................#............................................
                            .......#......................................................................................................................#.............
                            ......................#.......................................................#.............................................................
                            .#...........................................................#.....#..................................................#.................#...
                            ..................................#....................................................#....................................................
                            .................................................................................#..............................#...........................
                            ........#.................................#..........#......................................#............#..................................
                            ..................#........................................................#................................................................
                            .............................#................#......................#...............................#..........................#......#....
                            ..............#......................#..................................................................................#...................
                            ...............................................................................................................#............................
                            ..#.....................#.......................................#...................................................#.......................
                            ..................................#....................#..........................................#.........................................
                            ....................#.....................#......#.........................................................................#.......#........
                            ............................................................#..........#...................................................................#
                            ....#........................#................................................#...........#...............#......#..........................
                            ............................................................................................................................................
                            ..........#............................#....................................................................................................
                            ...............#...............................#......#.............................................#.................................#.....
                            ......................#..........#.........................#.......#..................................................#.....................
                            ...............................................................................................................#..................#........#
                            ............................................................................................................................................
                            #..........................#...............................................#.......#......#.................................................
                            ............................................................................................................................................
                            .......#......................................................#............................................................#........#.......
                            .............................................#.........#............................................#.....#.................................
                            ...............................#.......#....................................................................................................
                            .................................................................#..........................#..................#............................
                            ..............#.....#.........................................................#......#.....................................................#
                            .................................................#.......#.............#....................................................................
                            ..............................................................#............................................#................................
                            .#.......................#...............#.................................#.........................................................#......
                            ....................................#.....................................................#..............................#..................
                            .....#...........#..............................................................................#.....#.....................................
                            .................................................................#.................#........................................................
                            ............................................................................................................................................
                            .................................................#........................................................#.................................
                            ........#.........................................................................................#...........................#..........#..
                            ...............#........#...........#.....#........................#..............................................#................#........
                            ........................................................................................#...................................................
                            ...................................................................................#.........................#..............................
                            ...#..............#....................................................#............................#.......................................
                            ..............................#............................#................................................................................
                            ........................................#.............................................................................................#.....
                            ..............................................#..................#.............#........................#.................#.................
                            ...................................................#.............................................................#..........................
                            .........#..................................................................................................................................
                            .......................#.....................................#.......#.....#..............................................................#.
                            ................................................................................................#.....................#.....................
                            ....#...........................#......................#.............................#.......................................#..............
                            ...........................................................................................................#................................
                            ...........#.......#........#..............................#.....................................................#..........................
                            ............................................#...............................................#...............................................
                            ....................................................................#..............#..................#..............#...............#......
                            .....................................#........................#.............................................................................
                            ...............................................#............................................................#.................#............#
                            ............................................................................................................................................
                            ....#.......#...........................................................................................................#.........#.........
                            ...................................#................#...........#..............................#............................................
                            ............................................................................................................................................
                            .......................................................................#...........#......#..........#.......#..............................
                            ..............................................................................#......................................................#......
                            ...........................#.....................#..................................................................#.......................
                            ..#............#............................#................................................#..............................................
                            ...........................................................................................................................................#
                            ........................................#...............#............#..........#......................................#....................
                            ............#................................................#..............................................................................
                            .......#............................#...............#....................................#............#..........................#..........
                            ......................#....................................................#................................................................
                            ...............................................................................................#.............#.....#........................
                            ..................#....................................#.........#...............#..........................................................
                            .............#...............#................#........................................#.................................................#..
                            ...................................#....................................................................#...................#...............
                            .........................................#..........#.................#.....................................................................
                            ................#............................................................#..............................................................
                            ..........#.....................#........................#.....................................................................#............
                            ....#.................................#.............................................................................................#.......
                            ......................#.....#.......................................................................................#.......................
                            ..............................................#.........................................#...................................................
                            ..........................................................................................................#.................................
                            ...................................................................#.........................................................#..............
                            .........#....................#.........#.........#...........#....................................#......................................#.
                            ............................................................................................................................................
                            ..#........................................................................#...............#.............................#..................
                            ..............#...........#..........................................................#..........................................#...........
                            ...................#.................................#...............................................#......................................
                            ...............................#......................................................................................................#.....
                            ...........................................#.................#........#.......................#.............................................
                            .....................................#.....................................................................#......#.......#.................
                            ................#...............................#................................#......#..........#......................................#.
                            ........................#...................................................................................................................
                            ..............................#................................................................................................#............
                            .........................................................#...................#..........................#...................................
                            ....#.......................................................................................................................................
                            ........................................................................#........................#......................#.............#.....
                            ............#...............#.............#.........#............................#........#................#................................
                            .....................#...............#..............................................................................#.......................
                            ..................................................................#......................................................................#..
                            ............................................................................................................................................
                            ..............#........................................#.....................#.......#......................................................
                            ........................#..............................................#..............................................#........#............
                            ........................................#........................................#..........................................................
                            .......#........................#...................#.........#..............................................#..............................
                            ..#................#......................................................................#........................................#........
                            .................................................................................................#.......................#..................
                            ..............................................#.............................................................................................
                            .....#........#...........................................................................................#.........#........#..............
                            .................................................................................#..........#..........................................#....
                            ..........................#...................................#.........#..............#.........................................#..........
                            ............................................................................................................................................
                            ....................................................................#.......#...................#...........................................
                            ......................#.............#.............#.....................................................#...................................
                            ........................................................#........................................................#..........................
                            ..#..........#..........................#....................................................................................#.......#......
                          """;
}